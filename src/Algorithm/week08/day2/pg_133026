SELECT i.INGREDIENT_TYPE, SUM(IF(i.INGREDIENT_TYPE='sugar_based' OR i.INGREDIENT_TYPE='fruit_based',f.TOTAL_ORDER,0)) AS TOTAL_ORDER
FROM FIRST_HALF f INNER JOIN ICECREAM_INFO i ON i.FLAVOR =  f.FLAVOR GROUP BY i.INGREDIENT_TYPE;